var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DIALOG;!function(t){var e=function(e){function s(n,o,r,a,l,h,c,u){if(void 0===r&&(r=null),void 0===h&&(h=i.LAYOUT_HORIZONTAL),e.call(this,n,o,r,a,l),this._layoutDir=h,this._button=c,this._topLevel=u,this.horizontalMargin=.1,this.verticalMargin=.1,this.horizontalAlignment=i.ALIGN_LEFT,this.verticalAlignment=i.ALIGN_TOP,this.borderInsideVert=.05,this.borderDepth=t.DialogSys.DEPTH_SCALING_3D,this.stretchHorizontal=!1,this.stretchVertical=!1,this._bold=!1,this.maxViewportWidth=1,this.maxViewportHeight=1,this._fitToWindow=!1,this._maxAboveOrigin=BABYLON.Vector3.Zero(),this._minBelowOrigin=BABYLON.Vector3.Zero(),this._nStretchers=[0,0],this._xyScale=1,this._dirty=!0,this._visibleBorder=!1,this._panelEnabled=!0,this._selected=!1,this._subs=new Array,!i.BORDER_MAT){i.BORDER_MAT=t.DialogSys.GOLD[1];var d=new BABYLON.MultiMaterial("Top Level mat",t.DialogSys._scene);d.subMaterials.push(t.DialogSys.GOLD[1]);var _=t.DialogSys.BLACK[0].clone("transBlack");_.alpha=.3,d.subMaterials.push(_),i.TOP_LEVEL_BORDER_MAT=d}if(this.useGeometryForBorder()){var p=this._topLevel||this._button;this.setVerticesData(BABYLON.VertexBuffer.PositionKind,this._computePositionsData(1,1),!0),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,p?s._TOP_LEVEL_NORMALS:s._NORMALS,!1),this.setIndices(p?s._TOP_LEVEL_INDICES:s._INDICES),this.subMeshes=[],new BABYLON.SubMesh(0,0,40,0,168,this),p?(new BABYLON.SubMesh(1,40,4,168,6,this),this.material=i.TOP_LEVEL_BORDER_MAT):this.material=i.BORDER_MAT,this.setBorderVisible(this._topLevel)}this._topLevel&&e.prototype.registerBeforeRender.call(this,s._beforeRender),this.placeHolderWidth=this.getFullScalePlaceholderWidth(),this.placeHolderHeight=this.getFullScalePlaceholderHeight()}return __extends(s,e),s.prototype._computePositionsData=function(t,e){var i=this.borderInsideVert,s=t/2,n=-s,o=s-i,r=n+i,a=e/2,l=-a,h=a-i,c=l+i,u=this.borderDepth,d=[o,h,0,o,c,0,s,c,0,s,h,u,s,h,0,o,h,u,s,c,u,n,h,0,n,h,u,n,c,u,r,c,u,r,h,0,n,c,0,r,l,0,r,c,0,r,a,u,r,h,u,n,h,0,n,a,0,n,a,u,s,h,u,s,a,u,s,a,0,n,c,u,n,l,u,n,l,0,r,l,u,s,c,0,s,l,0,s,l,u,r,a,0,o,a,0,o,c,u,o,l,0,n,c,0,o,a,u,n,h,u,s,h,0,o,l,u,s,c,u];if(this._topLevel||this._button){this._button&&(u*=.1);var _=[o,c,u,o,h,u,r,h,u,r,c,u];d.push.apply(d,_)}return d},s._beforeRender=function(e){var i=e;i._dirty&&(i.layout(),t.DialogSys._adjustCameraForPanel())},s.prototype.setBorderVisible=function(t){this._visibleBorder=t,this.useGeometryForBorder&&(this.visibility=t?1:0)},s.prototype.isBorderVisible=function(){return this._visibleBorder},s.prototype.registerPickAction=function(e){this._pickFunc=e,this.actionManager=new BABYLON.ActionManager(t.DialogSys._scene);var i=this;this.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){i._pickFunc()}))},s.prototype.assignCallback=function(t){this._callback=t},s.prototype.isSelected=function(){return this._selected},s.prototype.isPanelEnabled=function(){return this._panelEnabled},s.prototype.isButton=function(){return this._button},s.prototype.setButton=function(t){this._button=t},Object.defineProperty(s.prototype,"fitToWindow",{get:function(){return this._fitToWindow},set:function(e){this._topLevel&&(this._fitToWindow=e,this._originalReqdWidth||(this._originalReqdWidth=this.getReqdWidth(),this._originalReqdHeight=this.getReqdHeight()),e||this.layout(),t.DialogSys._adjustCameraForPanel())},enumerable:!0,configurable:!0}),s.prototype.invalidateLayout=function(){this._dirty=!0;var t=this.parent;t&&"function"==typeof t.invalidateLayout&&t.invalidateLayout()},s.prototype.layout=function(){this._calcRequiredSize(),this._layout(this.getReqdWidth(),this.getReqdHeight()),this.freezeWorldMatrixTree(),this._dirty=!1},s.prototype._layout=function(t,e){this._validateAlignmnent(this._layoutDir===i.LAYOUT_HORIZONTAL)&&(t=this.stretchHorizontal?t:this.getReqdWidth(),e=this.stretchVertical?e:this.getReqdHeight(),this.useGeometryForBorder()&&this.updateVerticesData(BABYLON.VertexBuffer.PositionKind,this._computePositionsData(t,e),!0),this._layoutDir===i.LAYOUT_HORIZONTAL?this._horizontalLayout(t,e):this._verticalLayout(t,e),this._actualAboveOriginX=t/2,this._actualAboveOriginY=e/2,this._actualBelowOriginX=-t/2,this._actualBelowOriginY=-e/2,this._adjustLayoutForOrigin())},s.prototype._horizontalLayout=function(t,e){for(var s,n,o=this._nStretchers[0]>0?(t-this.getReqdWidth())/this._nStretchers[0]:0,r=e-2*this.verticalMargin,a=0;a<this._subs.length;a++)s=this._subs[a],s&&null!==s&&(n=s.getReqdWidth()+(s.stretchHorizontal?o:0),s._layout(n,r),s.position.y=s.verticalAlignment===i.ALIGN_BOTTOM?this.verticalMargin-s._actualBelowOriginY:s.verticalAlignment===i.ALIGN_VCENTER?(e-s.getReqdHeight())/2-s._actualBelowOriginY:e-(this.verticalMargin+s._actualAboveOriginY));for(var l=this.horizontalMargin,a=0;a<this._subs.length;a++)if(s=this._subs[a],s&&null!==s){if(s.horizontalAlignment===i.ALIGN_RIGHT)break;if(n=s.getReqdWidth()+(s.stretchHorizontal?o:0),s.horizontalAlignment!==i.ALIGN_LEFT){s.position.x=(t-n)/2-s._actualBelowOriginX;break}s.position.x=l-s._actualBelowOriginX,l+=n}else l+=this.placeHolderWidth;for(var h=t-this.horizontalMargin,a=this._subs.length-1;a>=0;a--)if(s=this._subs[a],s&&null!==s){if(s.horizontalAlignment!==i.ALIGN_RIGHT)break;n=s.getReqdWidth()+(s.stretchHorizontal?o:0),s.position.x=h-s._actualAboveOriginX,h-=n}else h-=this.placeHolderWidth},s.prototype._verticalLayout=function(t,e){for(var s,n,o=this._nStretchers[1]>0?(e-this.getReqdHeight())/this._nStretchers[1]:0,r=t-2*this.horizontalMargin,a=0;a<this._subs.length;a++)s=this._subs[a],s&&null!==s&&(n=s.getReqdHeight()+(s.stretchVertical?o:0),s._layout(r,n),s.position.x=s.stretchHorizontal?this.horizontalMargin-s._actualBelowOriginX:s.horizontalAlignment===i.ALIGN_LEFT?this.horizontalMargin-s._actualBelowOriginX:s.horizontalAlignment===i.ALIGN_HCENTER?(t-s.getReqdWidth())/2-s._actualBelowOriginX:t-(this.horizontalMargin+s._actualAboveOriginX));for(var l=e-this.verticalMargin,a=0;a<this._subs.length;a++)if(s=this._subs[a],s&&null!==s){if(s.verticalAlignment===i.ALIGN_BOTTOM)break;if(n=s.getReqdHeight()+(s.stretchVertical?o:0),s.verticalAlignment!==i.ALIGN_TOP){s.position.y=(e-n)/2-s._actualBelowOriginY;break}s.position.y=l-s._actualAboveOriginY,l-=n}else l-=this.placeHolderHeight;for(var h=this.verticalMargin,a=this._subs.length-1;a>=0;a--)if(s=this._subs[a],s&&null!==s){if(s.verticalAlignment!==i.ALIGN_BOTTOM)break;n=s.getReqdHeight()+(s.stretchVertical?o:0),s.position.y=h-s._actualBelowOriginY,h+=n}else h+=this.placeHolderHeight},s.prototype._adjustLayoutForOrigin=function(){for(var t,e=0;e<this._subs.length;e++)t=this._subs[e],t&&null!==t&&(t.position.x+=this._actualBelowOriginX,t.position.y+=this._actualBelowOriginY)},s.prototype._validateAlignmnent=function(t){for(var e,s,n,o=t?i.ALIGN_HCENTER:i.ALIGN_VCENTER,r=this._nStretchers[t?0:1]>0,a=0,l=-4,h=0;h<this._subs.length;h++)if(this._subs[h]&&null!==this._subs[h]){if(this._subs[h]._topLevel)return BABYLON.Tools.Error("Cannot embed top level panel in others.  Found in: "+this.name),!1;if(s=this._subs[h].horizontalAlignment,s<i.ALIGN_LEFT||s>i.ALIGN_RIGHT)return BABYLON.Tools.Error("Horizontal Layout value invalid for "+this._subs[h].name),!1;if(n=this._subs[h].verticalAlignment,n<i.ALIGN_TOP||n>i.ALIGN_BOTTOM)return BABYLON.Tools.Error("Vertical Layout value invalid for "+this._subs[h].name),!1;var e=t?s:n;if(!(e>=l))return BABYLON.Tools.Error("Must be in "+(t?"Lefts, up to 1 center, rights":"tops, up to 1 center, bottoms")+" order for: "+this.name),!1;if(l=e,e===o){if(r)return BABYLON.Tools.Error("Stretch & center alignments not compatible.  found amoung sub-panels of: "+this.name),!1;a++}}return a>1?(BABYLON.Tools.Error("Multiple center alignments not valid for: "+this.name),!1):!0},s.prototype._calcRequiredSize=function(){var t,e,s,n,o,r=[0,0,0],a=[0,0,0],l=0,h=0,c=0;this._nStretchers[0]=0,this._nStretchers[1]=0;for(var u,d=0;d<this._subs.length;d++)u=this._subs[d],u&&null!==u?(u.stretchHorizontal&&this._nStretchers[0]++,u.stretchVertical&&this._nStretchers[1]++,u._calcRequiredSize(),t=u.getReqdWidth(),e=u.getReqdHeight(),s=u.getReqdDepth(),u.horizontalAlignment===i.ALIGN_LEFT&&(n=0),u.horizontalAlignment===i.ALIGN_HCENTER&&(n=1),u.horizontalAlignment===i.ALIGN_RIGHT&&(n=2),u.verticalAlignment===i.ALIGN_TOP&&(o=0),u.verticalAlignment===i.ALIGN_HCENTER&&(o=1),u.verticalAlignment===i.ALIGN_BOTTOM&&(o=2),s>l&&(l=s),this._layoutDir===i.LAYOUT_HORIZONTAL?(e>c&&(c=e),r[n]+=t):(t>h&&(h=t),a[o]+=e)):this._layoutDir===i.LAYOUT_HORIZONTAL?r[n]+=this.placeHolderWidth:a[o]+=this.placeHolderHeight;this._layoutDir===i.LAYOUT_HORIZONTAL?(h=r[1],r[1]>0&&(r[0]<r[2]?r[0]=r[2]:r[2]=r[0]),h+=r[0]+r[2]):(c=a[1],a[1]>0&&(a[0]<a[2]?a[0]=a[2]:a[2]=a[0]),c+=a[0]+a[2]),this._maxAboveOrigin.z=l/2,this._minBelowOrigin.z=-this._maxAboveOrigin.z,this._assignRequirements(h,c,l)},s.prototype.getReqdWidth=function(){return this._maxAboveOrigin.x-(this._minBelowOrigin.x<0?this._minBelowOrigin.x:0)},s.prototype.getReqdHeight=function(){return this._maxAboveOrigin.y-(this._minBelowOrigin.y<0?this._minBelowOrigin.y:0)},s.prototype._assignRequirements=function(t,e,i){this._maxAboveOrigin.x=this.horizontalMargin+t/2,this._minBelowOrigin.x=-this._maxAboveOrigin.x,this._maxAboveOrigin.y=this.verticalMargin+e/2,this._minBelowOrigin.y=-this._maxAboveOrigin.y,(!i||i<this.borderDepth)&&(i=this.borderDepth),this._maxAboveOrigin.z=i/2,this._minBelowOrigin.z=-this._maxAboveOrigin.z},s.prototype.getReqdDepth=function(){return this._maxAboveOrigin.z-(this._minBelowOrigin.z<0?this._minBelowOrigin.z:0)},s.prototype.setLayerMask=function(e){for(var i=this._subs.length-1;i>=0;i--)null!==this._subs[i]&&(this._subs[i].setLayerMask(e),this._subs[i].setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER));this.layerMask=e,this.setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER)},s.prototype.getSubPanels=function(){return this._subs},s.prototype.addSubPanel=function(t,e){void 0!==e?this._subs.splice(e,0,t):this._subs.push(t),t&&null!==t&&(t.parent=this,this.setLayerMask(this.layerMask)),this.invalidateLayout()},s.prototype.removeAt=function(t,e){!e&&this._subs[t]&&this._subs[t]&&this._subs[t].dispose(),this._subs.splice(t,1),this.invalidateLayout()},s.prototype.removeAll=function(t){if(!t)for(var e=this._subs.length-1;e>=0;e--)this._subs[e]&&this._subs[e]&&this._subs[e].dispose();this._subs=new Array,this.invalidateLayout()},s.prototype.getRootPanel=function(){var t=this.parent;return t?t.getRootPanel():this},s.prototype.useGeometryForBorder=function(){return!0},s.prototype.getFullScalePlaceholderWidth=function(){return.3},s.prototype.getFullScalePlaceholderHeight=function(){return.2},s.prototype.setUniformZ=function(t){for(var e,i=this._subs.length-1;i>=0;i--)e=this._subs[i],e&&null!==e&&(e.position.z=t+this._minBelowOrigin.z);this.invalidateLayout()},s.prototype.setSubsFaceSize=function(e,i){i?this._xyScale*=e:this._xyScale=e;for(var n,o=this._subs.length-1;o>=0;o--)n=this._subs[o],n&&null!==n&&(n instanceof t.Letter?n.setFaceSize(e,i):n.setSubsFaceSize(e,i));var r=this._bold?this._xyScale*s.BOLD_MULT:this._xyScale;return this.placeHolderWidth=this.getFullScalePlaceholderWidth()*r,this.placeHolderHeight=this.getFullScalePlaceholderHeight()*this._xyScale,this},s.prototype.setFaceSize=function(t,e){return e?this._xyScale*=t:this._xyScale=t,this._scaleXY(),this},s.prototype.setBold=function(t){return this._bold=t,this._scaleXY(),this},s.prototype._scaleXY=function(){var t=this._bold?this._xyScale*s.BOLD_MULT:this._xyScale;this.scaling.x=t,this.scaling.y=this._xyScale,this.invalidateLayout()},s.prototype.scaleZ=function(t){for(var e,i=this._subs.length-1;i>=0;i--)e=this._subs[i],e&&null!==e&&(e.scaling.z=t);return this},s.prototype.stretch=function(t,e){return this.stretchVertical=t,this.stretchHorizontal=e,this.invalidateLayout(),this},s.prototype.vertAlign=function(t){return this.verticalAlignment=t,this.invalidateLayout(),this},s.prototype.horizontalAlign=function(t){return this.horizontalAlignment=t,this.invalidateLayout(),this},s.prototype.margin=function(t,e){return this.verticalMargin=t,this.horizontalMargin=e,this.invalidateLayout(),this},s.prototype.disolve=function(t,e){for(var i,s=this._subs.length-1;s>=0;s--)i=this._subs[s],i&&null!==i&&i.disolve(t,e);this!==e&&(this.visibility=this.isBorderVisible()?t:0,this._button&&(this.isPickable=!1))},s.prototype.reAppear=function(){for(var t,e=this._subs.length-1;e>=0;e--)t=this._subs[e],t&&null!==t&&t.reAppear();this.visibility=this.isBorderVisible()?1:0,this._button&&(this.isPickable=!0)},s.prototype.dispose=function(t){this.unregisterBeforeRender(s._beforeRender),e.prototype.dispose.call(this,!1)},s.prototype.freezeWorldMatrixTree=function(){this.freezeWorldMatrix();for(var t,e=this._subs.length-1;e>=0;e--)t=this._subs[e],t&&null!==t&&t.freezeWorldMatrixTree()},s.prototype.unfreezeWorldMatrixTree=function(){e.prototype.unfreezeWorldMatrix.call(this);for(var t,i=this._subs.length-1;i>=0;i--)t=this._subs[i],t&&null!==t&&t.unfreezeWorldMatrixTree()},s.BOLD_MULT=1.4,s._NORMALS=[0,0,-1,0,0,-1,.7071,0,-.7071,.7071,0,.7071,.7071,0,-.7071,0,0,1,.7071,0,.7071,-.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,0,0,1,0,0,-1,-.7071,0,-.7071,0,-.7071,-.7071,0,0,-1,0,.7071,.7071,0,0,1,-.7071,0,-.7071,-.5773,.5773,-.5773,-.5773,.5773,.5773,.7071,0,.7071,.5773,.5773,.5773,.5773,.5773,-.5773,-.7071,0,.7071,-.5773,-.5773,.5773,-.5773,-.5773,-.5773,0,-.7071,.7071,.7071,0,-.7071,.5773,-.5773,-.5773,.5773,-.5773,.5773,0,.7071,-.7071,0,.7071,-.7071,0,0,1,0,-.7071,-.7071,-.7071,0,-.7071,0,.7071,.7071,-.7071,0,.7071,.7071,0,-.7071,0,-.7071,.7071,.7071,0,.7071],s._TOP_LEVEL_NORMALS=[0,0,-1,0,0,-1,.7071,0,-.7071,.7071,0,.7071,.7071,0,-.7071,0,0,1,.7071,0,.7071,-.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,0,0,1,0,0,-1,-.7071,0,-.7071,0,-.7071,-.7071,0,0,-1,0,.7071,.7071,0,0,1,-.7071,0,-.7071,-.5773,.5773,-.5773,-.5773,.5773,.5773,.7071,0,.7071,.5773,.5773,.5773,.5773,.5773,-.5773,-.7071,0,.7071,-.5773,-.5773,.5773,-.5773,-.5773,-.5773,0,-.7071,.7071,.7071,0,-.7071,.5773,-.5773,-.5773,.5773,-.5773,.5773,0,.7071,-.7071,0,.7071,-.7071,0,0,1,0,-.7071,-.7071,-.7071,0,-.7071,0,.7071,.7071,-.7071,0,.7071,.7071,0,-.7071,0,-.7071,.7071,.7071,0,.7071,0,0,-1,0,0,-1,0,0,-1,0,0,-1],s._INDICES=[0,1,2,3,4,2,5,3,6,7,8,9,10,9,8,11,7,12,13,1,14,15,5,16,17,18,19,20,21,22,23,24,25,26,24,23,27,28,29,30,18,17,15,30,31,13,25,24,4,0,2,6,3,2,32,5,6,12,7,9,16,10,8,14,11,12,28,27,1,28,1,33,34,25,13,34,13,14,21,5,35,1,13,33,21,20,5,36,19,15,36,15,16,36,17,19,37,20,22,5,15,35,34,23,25,26,32,38,32,39,29,32,26,10,39,27,29,30,0,31,32,29,38,26,23,10,0,37,22,0,30,11,22,21,35,30,17,11,22,35,31,0,22,31,19,18,30,19,30,15,29,28,33,35,15,31,38,29,33,13,26,33,26,38,33,13,24,26],s._TOP_LEVEL_INDICES=[0,1,2,3,4,2,5,3,6,7,8,9,10,9,8,11,7,12,13,1,14,15,5,16,17,18,19,20,21,22,23,24,25,26,24,23,27,28,29,30,18,17,15,30,31,13,25,24,4,0,2,6,3,2,32,5,6,12,7,9,16,10,8,14,11,12,28,27,1,28,1,33,34,25,13,34,13,14,21,5,35,1,13,33,21,20,5,36,19,15,36,15,16,36,17,19,37,20,22,5,15,35,34,23,25,26,32,38,32,39,29,32,26,10,39,27,29,30,0,31,32,29,38,26,23,10,0,37,22,0,30,11,22,21,35,30,17,11,22,35,31,0,22,31,19,18,30,19,30,15,29,28,33,35,15,31,38,29,33,13,26,33,26,38,33,13,24,26,40,41,42,43,40,42],s}(BABYLON.Mesh);t.BasePanel=e;var i=function(e){function i(i,s,n){e.call(this,i,t.DialogSys._scene,null,null,!1,s,!1,n)}return __extends(i,e),i.makeList=function(e,s,n,o,r,a){void 0===n&&(n=i.LAYOUT_VERTICAL),void 0===o&&(o=1);var l=new i("list-"+e,i.LAYOUT_VERTICAL,a);l.setBorderVisible(!0);var h=e&&null!=e&&e.replace(" ","").length>0;if(h){var c=new t.Label(e);c.horizontalAlignment=i.ALIGN_HCENTER,r&&null!==r&&c.setLetterMaterial(r),l.addSubPanel(c)}var u=new i("listKids-"+e,n);u.setBorderVisible(h),n===i.LAYOUT_VERTICAL?u.stretchHorizontal=!0:u.stretchVertical=!0;for(var d=0;d<s.length;d++){var _=new t.Label(s[d]);_.setFontSize(o),n===i.LAYOUT_VERTICAL?_.stretchHorizontal=!0:_.stretchVertical=!0,u.addSubPanel(_)}return l.addSubPanel(u),l},i.nestPanels=function(e,s,n,o,r,a){void 0===n&&(n=i.LAYOUT_VERTICAL),void 0===o&&(o=!1);var l=new i("nest-"+e,i.LAYOUT_VERTICAL,a);if(l.setBorderVisible(o),e&&null!=e&&e.replace(" ","").length>0){var h=new t.Label(e);h.horizontalAlignment=i.ALIGN_HCENTER,r&&null!==r&&h.setLetterMaterial(r),l.addSubPanel(h)}var c=new i("nestKids-"+e,n);c.setBorderVisible(o),n===i.LAYOUT_VERTICAL?c.stretchHorizontal=!0:c.stretchVertical=!0;for(var u=0;u<s.length;u++)n===i.LAYOUT_VERTICAL?s[u].stretchHorizontal=!0:s[u].stretchVertical=!0,c.addSubPanel(s[u]);return l.addSubPanel(c),l},i.ExtractMax=function(t){for(var e=t.getVerticesData(BABYLON.VertexBuffer.PositionKind),i=new BABYLON.Vector3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),s=t.getTotalVertices(),n=0;s>n;n++){var o=new BABYLON.Vector3(e[3*n],e[3*n+1],e[3*n+2]);i=BABYLON.Vector3.Maximize(o,i)}return i},Object.defineProperty(i,"LAYOUT_HORIZONTAL",{get:function(){return i._LAYOUT_HORIZONTAL},enumerable:!0,configurable:!0}),Object.defineProperty(i,"LAYOUT_VERTICAL",{get:function(){return i._LAYOUT_VERTICAL},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_LEFT",{get:function(){return i._ALIGN_LEFT},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_HCENTER",{get:function(){return i._ALIGN_HCENTER},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_RIGHT",{get:function(){return i._ALIGN_RIGHT},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_TOP",{get:function(){return i._ALIGN_TOP},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_VCENTER",{get:function(){return i._ALIGN_VCENTER},enumerable:!0,configurable:!0}),Object.defineProperty(i,"ALIGN_BOTTOM",{get:function(){return i._ALIGN_BOTTOM},enumerable:!0,configurable:!0}),i._LAYOUT_HORIZONTAL=0,i._LAYOUT_VERTICAL=1,i._ALIGN_LEFT=-3,i._ALIGN_HCENTER=-2,i._ALIGN_RIGHT=-1,i._ALIGN_TOP=1,i._ALIGN_VCENTER=2,i._ALIGN_BOTTOM=3,i}(e);t.Panel=i}(DIALOG||(DIALOG={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DIALOG;!function(t){var e=function(e){function i(i,s){e.call(this,null,t.DialogSys._scene),this.verticalMargin=i,this.horizontalMargin=s,this.setEnabled(!1)}return __extends(i,e),i.prototype.useGeometryForBorder=function(){return!1},i.prototype.addSubPanel=function(t,e){BABYLON.Tools.Error("spacers can have no sub-panels")},i.prototype.getSubPanel=function(){return null},i.prototype.removeAt=function(t,e){},i.prototype.removeAll=function(t){},i}(t.BasePanel);t.Spacer=e}(DIALOG||(DIALOG={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DIALOG;!function(t){var e=function(t){function e(i,s,n,o,r){void 0===n&&(n=null),t.call(this,i,s,n,o,r),this.maxAboveY=e.LETTER_ABOVE,this.minBelowY=-.23,this._consolidated=!1,this.horizontalMargin=0,this.verticalMargin=0,this.visibility=0,this.setBorderVisible(!0)}return __extends(e,t),e.prototype.useGeometryForBorder=function(){return!1},e.prototype._layout=function(t,e){this._actualAboveOriginX||(this.visibility=1),this._actualAboveOriginX=this._maxAboveOrigin.x,this._actualAboveOriginY=this._maxAboveOrigin.y,this._actualBelowOriginX=this._minBelowOrigin.x,this._actualBelowOriginY=this._minBelowOrigin.y},e.prototype._calcRequiredSize=function(){if(!this._minWorld){var t=BABYLON.Tools.ExtractMinAndMax(this.getVerticesData(BABYLON.VertexBuffer.PositionKind),0,this.getTotalVertices());this._minWorld=t.minimum,this._maxWorld=t.maximum}this._maxAboveOrigin.x=this._maxWorld.x*(this._consolidated?1:this.scaling.x),this._maxAboveOrigin.y=this.maxAboveY*(this._consolidated?this._xyScale:this.scaling.y),this._maxAboveOrigin.z=this._maxWorld.z*this.scaling.z,this._minBelowOrigin.x=this._minWorld.x*(this._consolidated?1:this.scaling.x),this._minBelowOrigin.y=this.minBelowY*(this._consolidated?this._xyScale:this.scaling.y),this._minBelowOrigin.z=this._minWorld.z*this.scaling.z},e.prototype.addSubPanel=function(t,e){BABYLON.Tools.Error("Letters can have no sub-panels")},e.prototype.getSubPanel=function(){return null},e.prototype.removeAt=function(t,e){},e.prototype.removeAll=function(t){},e.LETTER_ABOVE=.682,e}(t.BasePanel);t.Letter=e}(DIALOG||(DIALOG={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DIALOG;!function(t){var e=function(e){function i(t,i){e.call(this,t.name+"_wrapper",t.getScene()),this._inside=t,this._needBorders=i,t.parent=this}return __extends(i,e),i.prototype.setMaterial=function(t){this._inside.material=t},i.prototype.useGeometryForBorder=function(){return this._needBorders},i.prototype._layout=function(t,e){this._actualAboveOriginX||(this.visibility=1),this._actualAboveOriginX=this._maxAboveOrigin.x,this._actualAboveOriginY=this._maxAboveOrigin.y,this._actualBelowOriginX=this._minBelowOrigin.x,this._actualBelowOriginY=this._minBelowOrigin.y},i.prototype._calcRequiredSize=function(){if(!this._minWorld){var t=BABYLON.Tools.ExtractMinAndMax(this._inside.getVerticesData(BABYLON.VertexBuffer.PositionKind),0,this._inside.getTotalVertices());this._minWorld=t.minimum,this._maxWorld=t.maximum}this._maxAboveOrigin.x=this._maxWorld.x*this._inside.scaling.x,this._maxAboveOrigin.y=this._maxWorld.y*this._inside.scaling.y,this._maxAboveOrigin.z=this._maxWorld.z*this._inside.scaling.z,this._needBorders&&(this._maxAboveOrigin.x+=this.horizontalMargin,this._maxAboveOrigin.y+=this.verticalMargin),this._minBelowOrigin.x=this._minWorld.x*this._inside.scaling.x,this._minBelowOrigin.y=this._minWorld.y*this._inside.scaling.y,this._minBelowOrigin.z=this._minWorld.z*this._inside.scaling.z,this._needBorders&&(this._minBelowOrigin.x-=this.horizontalMargin,this._minBelowOrigin.y-=this.verticalMargin)},i.prototype.setLayerMask=function(e){for(var i=this._inside.getChildren(),s=i.length-1;s>=0;s--)i[s].layerMask=e,i[s].setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER);this._inside.layerMask=e,this._inside.setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER),this.layerMask=e,this.setEnabled(e!==t.DialogSys.SUSPENDED_DIALOG_LAYER)},i.prototype.freezeWorldMatrixTree=function(){this.freezeWorldMatrix(),this._inside.freezeWorldMatrix();for(var t=this._inside.getChildren(),e=t.length-1;e>=0;e--)t[e].freezeWorldMatrix()},i.prototype.unfreezeWorldMatrixTree=function(){e.prototype.unfreezeWorldMatrix.call(this);for(var t=this._inside.getChildren(),i=t.length-1;i>=0;i--)t[i].unfreezeWorldMatrix()},i.prototype.addSubPanel=function(t,e){BABYLON.Tools.Error("wrappers can have no sub-panels")},i.prototype.getSubPanel=function(){return null},i.prototype.removeAt=function(t,e){},i.prototype.removeAll=function(t){},i.prototype.setSubsFaceSize=function(t,e){return e?this._xyScale*=t:this._xyScale=t,this._inside.scaling.x=this._xyScale,this._inside.scaling.y=this._xyScale,this.invalidateLayout(),this},i}(t.BasePanel);t.MeshWrapperPanel=e}(DIALOG||(DIALOG={}));var DIALOG;!function(t){var e=function(){function e(){}return e.initialize=function(i){if(e._scene=i,!e._camera){e._camera=new BABYLON.FreeCamera("DialogSysCamera",new BABYLON.Vector3(0,0,-2e3),i),e._camera.mode=BABYLON.Camera.ORTHOGRAPHIC_CAMERA,e._camera.layerMask=e.ACTIVE_DIALOG_LAYER,i.removeCamera(e._camera);var s=new BABYLON.Vector3(-20,50,-100);e._light=new BABYLON.PointLight("DialogSysLamp",s,i),e._light.intensity=1,e._light.includeOnlyWithLayerMask=e.ACTIVE_DIALOG_LAYER,window.addEventListener("resize",function(){t.DialogSys._adjustCameraForPanel()}),BABYLON.Tools.Log("Dialog system ("+e.Version+") initialized")}e.WHITE=e.buildFontMaterials("DialogSys.WHITE",new BABYLON.Color3(1,1,1)),e.BLACK=e.buildFontMaterials("DialogSys.BLACK",new BABYLON.Color3(0,0,0)),e.BLUE=e.buildFontMaterials("DialogSys.BLUE",new BABYLON.Color3(.0815,.162,.8),.8),e.GOLD=e.buildFontMaterials("DialogSys.GOLD",new BABYLON.Color3(1,.8136,.2218)),e.RED=e.buildFontMaterials("DialogSys.RED",new BABYLON.Color3(1,.0046,.0286)),e.GREY=e.buildFontMaterials("DialogSys.GREY",new BABYLON.Color3(.5,.5,.5)),e.LT_GREY=e.buildFontMaterials("DialogSys.LT_GREY",new BABYLON.Color3(.6,.6,.6)),e.ORANGE=e.buildFontMaterials("DialogSys.ORANGE",new BABYLON.Color3(1,.5,0)),e.GREEN=e.buildFontMaterials("DialogSys.GREEN",new BABYLON.Color3(.004,.319,.002)),t.FontFactory.loadStockTypefaces(i),e.CURRENT_FONT_MAT_ARRAY=e.WHITE;for(var n=i.lights.length-1;n>=0;n--)i.lights[n]!==e._light&&(i.lights[n].excludeWithLayerMask=e.ACTIVE_DIALOG_LAYER);i.onNewLightAdded=e.onNewLight},e.onNewLight=function(t,i,s){s===e._scene&&(t.excludeWithLayerMask=e.ACTIVE_DIALOG_LAYER)},e.dispose=function(){e._camera.dispose(),e._light.dispose(),e.WHITE[0].dispose(),e.WHITE[1].dispose(),e.BLACK[0].dispose(),e.BLACK[1].dispose(),e.BLUE[0].dispose(),e.BLUE[1].dispose(),e.GOLD[0].dispose(),e.GOLD[1].dispose(),e.RED[0].dispose(),e.RED[1].dispose(),e.GREY[0].dispose(),e.GREY[1].dispose(),e.LT_GREY[0].dispose(),e.LT_GREY[1].dispose(),e.ORANGE[0].dispose(),e.ORANGE[1].dispose(),e.GREEN[0].dispose(),e.GREEN[1].dispose(),e._scene.onNewLightAdded=null,e._scene=null},e.buildFontMaterials=function(t,i,s,n){void 0===s&&(s=1),void 0===n&&(n=1);var o=new Array(2),r=new BABYLON.StandardMaterial(t+"-3D",e._scene);return r.checkReadyOnlyOnce=!0,r.ambientColor=i,r.diffuseColor=1===s?i:new BABYLON.Color3(i.r*s,i.g*s,i.b*s),r.specularColor=new BABYLON.Color3(.5,.5,.5),r.specularPower=80,r.alpha=n,o[0]=r,r=r.clone(t+"-2D"),r.backFaceCulling=!1,o[1]=r,o},e.pushPanel=function(t){t._topLevel||BABYLON.Tools.Error("Only top Level panels can be used in displayPanel()"),0===t.getReqdWidth()&&t.layout(),e._dialogStack.length>0?e._dialogStack[e._dialogStack.length-1].setLayerMask(e.SUSPENDED_DIALOG_LAYER):(e._scene.addCamera(e._camera),0===e._scene.activeCameras.length&&e._scene.activeCameras.push(e._scene.activeCamera),e._scene.activeCameras.push(e._camera)),e._scene.activeCameras[0].layerMask=e.DEFAULT_LAYERMASK,e._dialogStack.push(t),e._adjustCameraForPanel(),t.setLayerMask(e.ACTIVE_DIALOG_LAYER)},e.popPanel=function(t){var i=e._dialogStack.pop(),s=i.modalReturnedValue;if(t?i.setLayerMask(e.DEFAULT_LAYERMASK):i.dispose(),e._dialogStack.length>0){var n=e._dialogStack[e._dialogStack.length-1];n.setLayerMask(e.ACTIVE_DIALOG_LAYER),e._adjustCameraForPanel(),n.modalReturnedValue=s,n.modalReturnCallBack&&n.modalReturnCallBack()}else e._scene.activeCameras.pop(),e._scene.removeCamera(e._camera);return s},e._adjustCameraForPanel=function(){if(e._dialogStack&&0!==e._dialogStack.length){var i=e._dialogStack[e._dialogStack.length-1];if(i.fitToWindow){var s=e._getScalingToWindow(i._originalReqdWidth,i._originalReqdHeight),n=i._originalReqdWidth*(s.y<s.x?s.x/s.y:1),o=i._originalReqdHeight*(s.y>s.x?s.y/s.x:1);i._assignRequirements(n,o),i._layout(i.getReqdWidth(),i.getReqdHeight()),i.freezeWorldMatrix()}var r=i.getReqdWidth()/2,a=i.getReqdHeight()/2;e._camera.orthoTop=a,e._camera.orthoBottom=-a,e._camera.orthoLeft=-r,e._camera.orthoRight=r,e._camera.getProjectionMatrix();var l,s=e._getScalingToWindow(r,a),n=window.innerWidth*(s.y<s.x?s.y/s.x:1),o=window.innerHeight*(s.y>s.x?s.x/s.y:1),h=i.maxViewportWidth*n/window.innerWidth,c=i.maxViewportHeight*o/window.innerHeight;switch(i.fitToWindow?t.Panel.ALIGN_HCENTER:i.horizontalAlignment){case t.Panel.ALIGN_LEFT:l=0;break;case t.Panel.ALIGN_HCENTER:l=(1-h)/2;break;case t.Panel.ALIGN_RIGHT:l=1-h}var u;switch(i.fitToWindow?t.Panel.ALIGN_VCENTER:i.verticalAlignment){case t.Panel.ALIGN_TOP:u=1-c;break;case t.Panel.ALIGN_VCENTER:u=(1-c)/2;break;case t.Panel.ALIGN_BOTTOM:u=0}e._camera.viewport=new BABYLON.Viewport(l,u,h,c)}},e._getScalingToWindow=function(t,e){return new BABYLON.Vector2(window.innerWidth/t,window.innerHeight/e)},Object.defineProperty(e,"Version",{get:function(){return"1.1.0"},enumerable:!0,configurable:!0}),e.ACTIVE_DIALOG_LAYER=268435456,e.SUSPENDED_DIALOG_LAYER=0,e.DEFAULT_LAYERMASK=268435455,e._dialogStack=new Array,e.USE_CULLING_MAT_FOR_2D=!0,e.DEPTH_SCALING_3D=.05,e}();t.DialogSys=e}(DIALOG||(DIALOG={}));var DIALOG;!function(t){var e=function(){function e(){}return e.loadStockTypefaces=function(e){"undefined"!=typeof Font3D&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font3D.MeshFactory(e)),t.Label.DEFAULT_FONT_MODULE="Font3D",BABYLON.Tools.Log("Font3D loaded")),"undefined"!=typeof Font2D&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font2D.MeshFactory(e)),t.Label.DEFAULT_FONT_MODULE="Font2D",BABYLON.Tools.Log("Font2D loaded")),"undefined"!=typeof Font3D_EXT&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font3D_EXT.MeshFactory(e)),BABYLON.Tools.Log("Font3D_EXT loaded")),"undefined"!=typeof Font2D_EXT&&(TOWER_OF_BABEL.MeshFactory.MODULES.push(new Font2D_EXT.MeshFactory(e)),BABYLON.Tools.Log("Font2D_EXT loaded"))},e.getLetters=function(e,i,s){for(var n,o=new Array(e.length),r=i.indexOf("3D")>-1,a=e.length-1;a>=0;a--){n=i+(e[a].charCodeAt(0)>128?"_EXT":"");var l=" "!==e[a]?TOWER_OF_BABEL.MeshFactory.instance(n,e[a]):null;l?null!==l&&(l.material=s?s:t.DialogSys.CURRENT_FONT_MAT_ARRAY[r||t.DialogSys.USE_CULLING_MAT_FOR_2D?0:1],r&&(l.scaling.z=t.DialogSys.DEPTH_SCALING_3D)):l=null,o[a]=l}return o},e}();t.FontFactory=e}(DIALOG||(DIALOG={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DIALOG;!function(t){var e=function(e){function i(s,n,o,r,a){void 0===n&&(n=i.DEFAULT_FONT_MODULE),e.call(this,s,t.DialogSys._scene,null,null,!1,t.Panel.LAYOUT_HORIZONTAL,r),this._prohibitMerging=a,this._merged=!1,this._isTypeface3D=n.indexOf("3D")>-1;for(var l=t.FontFactory.getLetters(s,n,o),h=0;h<l.length;h++)this.addSubPanel(l[h]);this.setUniformZ(0),r||(this.material=t.DialogSys.ORANGE[1],this.verticalMargin=.02)}return __extends(i,e),i.prototype.setFontSize=function(t,e){return this.setSubsFaceSize(t,e)},i.prototype.setLetterMaterial=function(e,i){var s,n=e[this._isTypeface3D||t.DialogSys.USE_CULLING_MAT_FOR_2D?0:1],o=this.getSubPanels(),r=-1;i&&(r=this.name.indexOf(i),s=r+i.length-1),-1===r&&(r=0,s=o.length-1);for(var a=r;s>=a;a++)null!==o[a]&&(o[a].material=n);return this},i.prototype.getFullScalePlaceholderWidth=function(){return.15},i.prototype.addSubPanel=function(i,s){return!i||i instanceof t.Letter?void e.prototype.addSubPanel.call(this,i,s):void BABYLON.Tools.Error("Labels can contain only letters")},i.prototype._calcRequiredSize=function(){e.prototype._calcRequiredSize.call(this),!i.NO_MERGING&&!this._prohibitMerging&&this.getSubPanels().length>1&&!this._merged&&(this._mergeMeshes(),e.prototype._calcRequiredSize.call(this))},i.prototype._mergeMeshes=function(){for(var e,i,s,n,o,r=this.getSubPanels(),a=r.length,l=0,h=0,c=0,u=new Array,d=t.DialogSys._scene.getEngine().getCaps().uintIndices?1e6:65536,_=0;a>_;_++)e=r[_],e&&null!==e?(e.parent=null,s=e.getReqdWidth(),l+=e.getTotalVertices(),n&&(e.material!==i||l>d?(u.push(this._bigLetter(i,n)),n=void 0,l=0,h=0):(o=this._extractVertexData(e,h+c*this.placeHolderWidth),n.merge(o))),n||(i=e.material,n=this._extractVertexData(e,c*this.placeHolderWidth)),h+=s+c*this.placeHolderWidth,c=0):c++;u.push(this._bigLetter(i,n)),this.removeAll();for(var p=0;p<u.length;p++)this.addSubPanel(u[p]);this._merged=!0},i.prototype._extractVertexData=function(t,e){var i=BABYLON.VertexData.ExtractFromMesh(t,!0);return t.position.x=e,t.computeWorldMatrix(!0),i.transform(t.worldMatrixFromCache),t.dispose(),i},i.prototype._bigLetter=function(e,i){var s=new t.Letter(this.name+"-merged",t.DialogSys._scene);return i.applyToMesh(s),s.material=e,s._xyScale=this._xyScale,s._consolidated=!0,
s._calcRequiredSize(),s},i.NO_MERGING=!1,i}(t.BasePanel);t.Label=e}(DIALOG||(DIALOG={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DIALOG;!function(t){var e=function(e){function i(s,n,o){void 0===n&&(n=t.Label.DEFAULT_FONT_MODULE),e.call(this,s,n,null,!0,o),i.factory||(i.factory=new CheckBoxFont.MeshFactory(t.DialogSys._scene));var r=this;this.registerPickAction(function(){r._panelEnabled&&r.setSelected(!this._selected)})}return __extends(i,e),i.prototype._assignCheckMesh=function(){var e,s=this.getSubPanels();null!==s[0]&&(e=s[0].position,s[0].dispose()),this._isTypeface3D?(s[0]=i.factory.instance(this._selected?"checked3D":"unchecked3D"),s[0].scaling.z=t.DialogSys.DEPTH_SCALING_3D):s[0]=i.factory.instance(this._selected?"checked2D":"unchecked2D");for(var n=s.length-1;null===s[n];)n--;s[0].material=s[n].material,s[0].scaling.x=s[n]._xyScale,s[0].scaling.y=s[n]._xyScale,s[0].layerMask=s[n].layerMask,s[0].parent=this,s[0]._calcRequiredSize(),s[0].visibility=1,e&&(s[0].position=e)},i.prototype.setSelected=function(t){this._selected=t,this._assignCheckMesh(),this._callback&&this._callback(this)},i.prototype.enableButton=function(e){this._panelEnabled=e,this.setLetterMaterial(e?t.DialogSys.CURRENT_FONT_MAT_ARRAY:t.DialogSys.LT_GREY)},i.prototype._calcRequiredSize=function(){e.prototype._calcRequiredSize.call(this);var t=this.getSubPanels();t[0]instanceof CheckBoxFont.unchecked2D||t[0]instanceof CheckBoxFont.checked2D||t[0]instanceof CheckBoxFont.unchecked3D||t[0]instanceof CheckBoxFont.checked3D||(this.addSubPanel(null,0),this.addSubPanel(null,0),this._assignCheckMesh(),e.prototype._calcRequiredSize.call(this))},i}(t.Label);t.CheckBox=e}(DIALOG||(DIALOG={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},CheckBoxFont;!function(t){function e(t,e){var i=o[t];if(!i||null===i)return i||(o[t]=new Array),null;for(var s=i.length-1;s>=0;s--)if(i[s].geometry||e)return i[s];return null}function i(t){var e=o[t];if(e&&null!==e){for(var i=!1,s=e.length-1;s>=0;s--)e[s].geometry?i=!0:e[s]=null;i||(o[t]=null)}}function s(){return[r,a,l]}function n(t,e){if(void 0===e&&(e="./"),!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";if(!c){e.lastIndexOf("/")+1!==e.length&&(e+="/");c=!0}}var o=new Array(4),r=1,a=0,l=0,h=function(){function i(e,i){void 0===i&&(i="./"),this._scene=e,t.defineMaterials(e,i)}return i.prototype.getModuleName=function(){return"CheckBoxFont"},i.prototype.instance=function(t,i){var s,n=null;switch(t){case"unchecked2D":s=e(0),null===s?(n=new u("unchecked2D",this._scene),a+=n.getTotalVertices(),o[0].push(n)):(n=new u("unchecked2D_"+r++,this._scene,null,s),l+=n.getTotalVertices());break;case"checked2D":s=e(1),null===s?(n=new d("checked2D",this._scene),a+=n.getTotalVertices(),o[1].push(n)):(n=new d("checked2D_"+r++,this._scene,null,s),l+=n.getTotalVertices());break;case"checked3D":s=e(2),null===s?(n=new _("checked3D",this._scene),a+=n.getTotalVertices(),o[2].push(n)):(n=new _("checked3D_"+r++,this._scene,null,s),l+=n.getTotalVertices());break;case"unchecked3D":s=e(3),null===s?(n=new p("unchecked3D",this._scene),a+=n.getTotalVertices(),o[3].push(n)):(n=new p("unchecked3D_"+r++,this._scene,null,s),l+=n.getTotalVertices())}if(null!==n){if(i&&s&&s.skeleton){var h=s.skeleton.name+r;n.skeleton=s.skeleton.clone(h,h)}}else BABYLON.Tools.Error("Mesh not found: "+t);return n},i}();t.MeshFactory=h,t.getStats=s;var c=!1;t.defineMaterials=n;var u=function(e){function s(i,s,n,o){void 0===n&&(n="./"),e.call(this,i,s,null,o,!0),t.defineMaterials(s,n);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.6,0,0,-.05,0,0,-.05,.05,0,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,.6,0,-.05,.6,0,-.05,.65,0,0,0,0,0,.65,0,-.05,.65,0,-.6,.05,0,-.65,0,0,-.6,.65,0,-.05,0,0],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),this.setIndices([0,1,2,3,4,5,6,7,8,9,10,11,12,0,2,13,3,5,14,6,8,15,9,11]),this.subMeshes=[],new BABYLON.SubMesh(0,0,16,0,24,this),this.computeWorldMatrix(!0))}return __extends(s,e),s.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(0)},s}(DIALOG.Letter);t.unchecked2D=u;var d=function(e){function s(i,s,n,o){void 0===n&&(n="./"),e.call(this,i,s,null,o,!0),t.defineMaterials(s,n);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.1305,.1659,0,-.4841,.5195,0,-.5195,.4841,0,-.4841,.1305,0,-.1305,.4841,0,-.1659,.5195,0,-.6,0,0,-.05,0,0,-.05,.05,0,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,.6,0,-.05,.6,0,-.05,.65,0,0,0,0,0,.65,0,-.05,.65,0,-.1659,.1305,0,-.5195,.1659,0,-.6,.05,0,-.65,0,0,-.6,.65,0,-.05,0,0],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),this.setIndices([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,0,2,19,3,5,20,6,8,21,9,11,22,12,14,23,15,17]),this.subMeshes=[],new BABYLON.SubMesh(0,0,24,0,36,this),this.computeWorldMatrix(!0))}return __extends(s,e),s.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(1)},s}(DIALOG.Letter);t.checked2D=d;var _=function(e){function s(i,s,n,o){void 0===n&&(n="./"),e.call(this,i,s,null,o,!0),t.defineMaterials(s,n);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.1305,.1659,0,-.4841,.5195,0,-.5195,.4841,0,-.1659,.1305,0,-.1659,.1305,1,-.4841,.5195,1,-.5195,.4841,1,-.4841,.1305,0,-.1305,.4841,0,-.1659,.5195,0,-.5195,.1659,0,-.5195,.1659,1,-.4841,.1305,1,-.1305,.4841,1,-.1659,.5195,1,-.6,0,0,-.05,0,0,-.05,.05,0,-.6,.05,0,-.6,.05,1,-.6,0,1,-.05,0,1,-.05,.05,1,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,0,1,-.65,0,0,-.6,.65,1,-.65,.65,1,-.6,.6,0,-.05,.6,0,-.05,.65,0,-.6,.6,1,-.6,.65,0,-.05,.65,1,0,0,0,0,.65,0,-.05,.65,0,0,0,1,-.05,0,0,0,.65,1,-.05,.65,1,-.1305,.1659,1,-.65,0,1,-.6,.65,1,-.05,.6,1,-.05,0,1],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[.8165,0,-.5773,0,.8165,-.5773,-.8165,0,-.5773,0,-.8165,-.5773,0,-1,0,0,1,0,-1,0,0,0,-.8165,-.5773,.8165,0,-.5773,0,.8165,-.5773,-.8165,0,-.5773,-1,0,0,0,-1,0,1,0,0,0,1,0,-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,-.7071,.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.7071,-.7071,0,-.5773,.5773,-.5773,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,1,0,0,-.7071,-.7071,0,-.7071,.7071,0,.7071,-.7071,0,-.7071,-.7071,0],!1),this.setIndices([0,1,2,0,3,4,5,1,0,2,1,5,3,2,6,7,8,9,7,10,11,8,7,12,9,8,13,10,9,14,15,16,17,15,18,19,16,15,20,17,16,21,18,17,22,23,24,25,26,23,27,28,24,23,29,25,24,27,25,29,30,31,32,33,30,34,31,30,33,35,32,31,34,32,35,36,37,38,39,36,40,41,37,36,42,38,37,40,38,42,3,0,2,43,0,4,43,5,0,6,2,5,4,3,6,10,7,9,12,7,11,13,8,12,14,9,13,11,10,14,18,15,17,20,15,19,21,16,20,22,17,21,19,18,22,27,23,25,44,26,27,26,28,23,28,29,24,44,27,29,34,30,32,45,33,34,46,31,33,46,35,31,45,34,35,40,36,38,47,39,40,39,41,36,41,42,37,47,40,42]),this.subMeshes=[],new BABYLON.SubMesh(0,0,48,0,180,this),this.computeWorldMatrix(!0))}return __extends(s,e),s.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(2)},s}(DIALOG.Letter);t.checked3D=_;var p=function(e){function s(i,s,n,o){void 0===n&&(n="./"),e.call(this,i,s,null,o,!0),t.defineMaterials(s,n);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=1,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.6,0,0,-.05,0,0,-.05,.05,0,-.6,.05,0,-.6,.05,1,-.6,0,1,-.05,0,1,-.05,.05,1,-.6,0,0,-.6,.65,0,-.65,.65,0,-.6,0,1,-.65,0,0,-.6,.65,1,-.65,.65,1,-.6,.6,0,-.05,.6,0,-.05,.65,0,-.6,.6,1,-.6,.65,0,-.05,.65,1,0,0,0,0,.65,0,-.05,.65,0,0,0,1,-.05,0,0,0,.65,1,-.05,.65,1,-.65,0,1,-.6,.65,1,-.05,.6,1,-.05,0,1],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,-.7071,.7071,0,-.7071,-.7071,0,.7071,-.7071,0,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,-.5773,-.5773,-.5773,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.7071,-.7071,0,-.5773,.5773,-.5773,.7071,.7071,0,.5773,-.5773,-.5773,.5773,.5773,-.5773,-.5773,.5773,-.5773,.7071,-.7071,0,-.5773,-.5773,-.5773,.7071,.7071,0,-.7071,.7071,0,-.7071,-.7071,0,-.7071,.7071,0,.7071,-.7071,0,-.7071,-.7071,0],!1),this.setIndices([0,1,2,0,3,4,1,0,5,2,1,6,3,2,7,8,9,10,11,8,12,13,9,8,14,10,9,12,10,14,15,16,17,18,15,19,16,15,18,20,17,16,19,17,20,21,22,23,24,21,25,26,22,21,27,23,22,25,23,27,3,0,2,5,0,4,6,1,5,7,2,6,4,3,7,12,8,10,28,11,12,11,13,8,13,14,9,28,12,14,19,15,17,29,18,19,30,16,18,30,20,16,29,19,20,25,21,23,31,24,25,24,26,21,26,27,22,31,25,27]),this.subMeshes=[],new BABYLON.SubMesh(0,0,32,0,120,this),this.computeWorldMatrix(!0))}return __extends(s,e),s.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(3)},s}(DIALOG.Letter);t.unchecked3D=p}(CheckBoxFont||(CheckBoxFont={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DIALOG;!function(t){var e=function(e){function i(s,n,o){if(void 0===n&&(n=i.ACTION_BUTTON),e.call(this,s,o,null,!0),this._button_type=n,this._chngInProgress=!1,this._sysHideButton=!1,this._disolvedState=1,!i.MAT){var r=new BABYLON.MultiMaterial("button",t.DialogSys._scene);r.subMaterials.push(t.DialogSys.GREY[1]),r.subMaterials.push(t.DialogSys.GREY[0]),i.MAT=r,r=new BABYLON.MultiMaterial("button selected",t.DialogSys._scene),r.subMaterials.push(t.DialogSys.ORANGE[1]),r.subMaterials.push(t.DialogSys.GREY[0]),i.SELECTED_MAT=r}this.setBorderVisible(!0),this.borderInsideVert*=1.5,this.horizontalMargin*=1.5,this.verticalMargin*=1.5,this.setFontSize(.65),this.setSelected(!1),this.enableButton(!0);var a=this;this.registerPickAction(function(){a._panelEnabled&&a.setSelected(!0)}),this._button_type===i.ACTION_BUTTON&&e.prototype.registerAfterRender.call(this,i._delayedStart)}return __extends(i,e),i._delayedStart=function(t){var e=t;e._chngInProgress?1===e._disolvedState||0===e._disolvedState?(e.setSelected(!1),e._chngInProgress=!1,e._callback&&e._callback(e)):(e._disolvedState=Math.max(e._disolvedState-i.DISOLVE_STEP_RATE,0),e._rootPanel.disolve(e._disolvedState,e)):e.material==i.SELECTED_MAT&&(e._chngInProgress=!0)},i.prototype.setSelected=function(t,e){this._selected=t;var s=0===this._disolvedState;this.material=s?i._DISOLVED_MAT:t?i.SELECTED_MAT:i.MAT,e||this._group&&this._group.reportSelected(this),this._sysHideButton&&(this._chngInProgress||(this._rootPanel=this.getRootPanel(),s?(this._rootPanel.reAppear(),this._disolvedState=1,this.material=i.SELECTED_MAT):this._disolvedState=.99))},i.prototype.enableButton=function(e){this._panelEnabled=e,this.setLetterMaterial(e?t.DialogSys.BLACK:t.DialogSys.LT_GREY)},Object.defineProperty(i.prototype,"radioGroup",{set:function(t){this._button_type===i.RADIO_BUTTON?this._group=t:BABYLON.Tools.Error("Button not radio type")},enumerable:!0,configurable:!0}),i.prototype.hideSystemOnClick=function(e){if(this._sysHideButton=e,e&&!i._DISOLVED_MAT){var s=new BABYLON.StandardMaterial("Clear",t.DialogSys._scene);s.checkReadyOnlyOnce=!0,s.emissiveColor=new BABYLON.Color3(1,1,1),s.alpha=0;var n=new BABYLON.MultiMaterial("disolved_button",t.DialogSys._scene);n.subMaterials.push(s),n.subMaterials.push(s),i._DISOLVED_MAT=n}},i.prototype.isSystemHidden=function(){return 0===this._disolvedState},i.prototype.dispose=function(t){e.prototype.dispose.call(this,!1),this.unregisterAfterRender(i._delayedStart)},i.prototype.reAppearNoCallback=function(){this._rootPanel=this.getRootPanel(),this._rootPanel.reAppear(),this._disolvedState=1,this.material=i.MAT},Object.defineProperty(i,"ACTION_BUTTON",{get:function(){return i._ACTION_BUTTON},enumerable:!0,configurable:!0}),Object.defineProperty(i,"RADIO_BUTTON",{get:function(){return i._RADIO_BUTTON},enumerable:!0,configurable:!0}),i.DISOLVE_STEP_RATE=.012,i._ACTION_BUTTON=0,i._RADIO_BUTTON=2,i}(t.Label);t.Button=e}(DIALOG||(DIALOG={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DIALOG;!function(t){var e=function(e){function i(i,s,n,o){if(void 0===n&&(n=t.Panel.LAYOUT_VERTICAL),e.call(this,i,t.DialogSys._scene,null,null,!1,t.Panel.LAYOUT_VERTICAL,o),this._callbacks=new Array,this.setBorderVisible(!0),i&&null!=i&&i.replace(" ","").length>0){var r=new t.Label(i);r.horizontalAlignment=t.Panel.ALIGN_HCENTER,e.prototype.addSubPanel.call(this,r)}this._menu=new t.BasePanel("menu-"+i,t.DialogSys._scene,null,null,!1,n);for(var a=0;a<s.length;a++){var l=new t.Button(s[a],t.Button.RADIO_BUTTON);l.stretchHorizontal=n===t.Panel.LAYOUT_VERTICAL,l.radioGroup=this,this._menu.addSubPanel(l)}e.prototype.addSubPanel.call(this,this._menu)}return __extends(i,e),i.prototype.assignMenuCallback=function(t,e){this._callbacks[t]=e},i.prototype.reportSelected=function(t){for(var e=this._menu.getSubPanels(),i=0;i<e.length;i++){var s=e[i];s!=t?s.setSelected(!1,!0):(this._selectedIndex=i,this._callbacks[i]&&null!==this._callbacks[i]&&this._callbacks[i](s))}},Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){this._menu.getSubPanels()[t].setSelected(!0)},enumerable:!0,configurable:!0}),i.prototype.addSubPanel=function(e,i){return!e||e instanceof t.Button?(this._menu.addSubPanel(e,i),void(i?this._callbacks.splice(i,0,null):this._callbacks.push(null))):void BABYLON.Tools.Error("Labels can contain only Buttons")},i.prototype.removeAt=function(t){e.prototype.removeAt.call(this,t),this._callbacks.splice(t,1)},i.prototype.removeAll=function(){e.prototype.removeAll.call(this),this._callbacks=new Array},i}(t.BasePanel);t.Menu=e}(DIALOG||(DIALOG={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DigitParts;!function(t){function e(t,e){var i=p[t];if(!i||null===i)return i||(p[t]=new Array),null;for(var s=i.length-1;s>=0;s--)if(i[s].geometry||e)return i[s];return null}function i(t){var e=p[t];if(e&&null!==e){for(var i=!1,s=e.length-1;s>=0;s--)e[s].geometry?i=!0:e[s]=null;i||(p[t]=null)}}function s(){return[g,f,A]}function n(t,e,i){if(void 0===e&&(e="./"),void 0===i&&(i=!1),!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";if(!y){e.lastIndexOf("/")+1!==e.length&&(e+="/");var s;s=new BABYLON.StandardMaterial("DigitParts.border",t),s.ambientColor=new BABYLON.Color3(.0574,.8,.0876),s.diffuseColor=new BABYLON.Color3(.0459,.64,.0701),s.specularColor=new BABYLON.Color3(.5,.5,.5),s.emissiveColor=new BABYLON.Color3(0,0,0),s.specularPower=50,s.alpha=1,s.backFaceCulling=!0,s.checkReadyOnlyOnce=!i,s=new BABYLON.StandardMaterial("DigitParts.border.001",t),s.ambientColor=new BABYLON.Color3(.0574,.8,.0876),s.diffuseColor=new BABYLON.Color3(.0459,.64,.0701),s.specularColor=new BABYLON.Color3(.5,.5,.5),s.emissiveColor=new BABYLON.Color3(0,0,0),s.specularPower=50,s.alpha=1,s.backFaceCulling=!0,s.checkReadyOnlyOnce=!i,s=new BABYLON.StandardMaterial("DigitParts.face",t),s.ambientColor=new BABYLON.Color3(.8,.1603,.7314),s.diffuseColor=new BABYLON.Color3(.64,.1283,.5851),s.specularColor=new BABYLON.Color3(.5,.5,.5),s.emissiveColor=new BABYLON.Color3(0,0,0),s.specularPower=50,s.alpha=1,s.backFaceCulling=!0,s.checkReadyOnlyOnce=!i,s=new BABYLON.StandardMaterial("DigitParts.face.001",t),s.ambientColor=new BABYLON.Color3(.8,.1603,.7314),s.diffuseColor=new BABYLON.Color3(.64,.1283,.5851),s.specularColor=new BABYLON.Color3(.5,.5,.5),s.emissiveColor=new BABYLON.Color3(0,0,0),s.specularPower=50,s.alpha=1,s.backFaceCulling=!0,s.checkReadyOnlyOnce=!i,o(t),y=!0}}function o(t){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var e;e=new BABYLON.MultiMaterial("DigitParts.Multimaterial#0",t),e.id="DigitParts.Multimaterial#0",e.subMaterials.push(t.getMaterialByID("DigitParts.border")),e.subMaterials.push(t.getMaterialByID("DigitParts.face")),e=new BABYLON.MultiMaterial("DigitParts.Multimaterial#1",t),e.id="DigitParts.Multimaterial#1",e.subMaterials.push(t.getMaterialByID("DigitParts.border.001")),e.subMaterials.push(t.getMaterialByID("DigitParts.face.001"))}function r(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var s=new BABYLON.Mesh(e.name+".botLeft",t,e,i),n=i&&null!==i;return s.id=s.name,s.billboardMode=0,s.position.x=0,s.position.y=0,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,n||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.12,.12,0,.12,.46,0,0,.46,0,0,.12,0,0,0,0,.12,.12,0,0,.5196,0,0,.46,0,.1198,.46,0,0,.12,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),s.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,s),s.computeWorldMatrix(!0)),s}function a(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var s=new BABYLON.Mesh(e.name+".topLeft",t,e,i),n=i&&null!==i;return s.id=s.name,s.billboardMode=0,s.position.x=0,s.position.y=.5396,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,n||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,.0596,0,.12,.0596,0,.12,.3996,0,0,.3996,0,.12,.3996,0,0,.5196,0,0,0,0,.1198,.0596,0,0,.0596,0,0,.3996,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),s.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,s),s.computeWorldMatrix(!0)),s}function l(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var s=new BABYLON.Mesh(e.name+".top",t,e,i),n=i&&null!==i;return s.id=s.name,s.billboardMode=0,s.position.x=.03,s.position.y=1.0579,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,n||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.42,0,0,.12,0,0,.12,-.12,0,.42,0,0,.42,-.12,0,.54,0,0,.12,0,0,0,0,0,.12,-.12,0,.42,-.12,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),s.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,s),s.computeWorldMatrix(!0)),s}function h(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var s=new BABYLON.Mesh(e.name+".topRite",t,e,i),n=i&&null!==i;return s.id=s.name,s.billboardMode=0,s.position.x=.6,s.position.y=.5396,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,n||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.12,.3996,0,-.12,.0596,0,0,.0596,0,0,.3996,0,0,.5196,0,-.12,.3996,0,0,0,0,0,.0596,0,-.1198,.0596,0,0,.3996,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),s.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,s),s.computeWorldMatrix(!0)),s}function c(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var s=new BABYLON.Mesh(e.name+".botRite",t,e,i),n=i&&null!==i;return s.id=s.name,s.billboardMode=0,s.position.x=.6,s.position.y=.5196,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,n||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,-.0596,0,-.12,-.0596,0,-.12,-.3996,0,0,-.3996,0,-.12,-.3996,0,0,-.5196,0,0,0,0,-.1198,-.0596,0,0,-.0596,0,0,-.3996,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),s.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,s),s.computeWorldMatrix(!0)),s}function u(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var s=new BABYLON.Mesh(e.name+".bottom",t,e,i),n=i&&null!==i;return s.id=s.name,s.billboardMode=0,s.position.x=.03,s.position.y=0,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,n||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.12,.12,0,.12,0,0,.42,0,0,.12,0,0,.12,.12,0,0,0,0,.42,0,0,.54,0,0,.42,.12,0,.42,.12,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,7,8,9,0,2]),s.subMeshes=[],new BABYLON.SubMesh(0,0,10,0,12,s),s.computeWorldMatrix(!0)),s}function d(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var s=new BABYLON.Mesh(e.name+".dot",t,e,i),n=i&&null!==i;return s.id=s.name,s.billboardMode=0,s.position.x=.64,s.position.y=-4e-4,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,n||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[.12,0,0,.12,.12,0,0,.12,0,0,0,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,0,2]),s.subMeshes=[],new BABYLON.SubMesh(0,0,4,0,6,s),s.computeWorldMatrix(!0)),s}function _(t,e,i){if(!BABYLON.Engine.Version||Number(BABYLON.Engine.Version.substr(0,BABYLON.Engine.Version.lastIndexOf(".")))<2)throw"Babylon version too old";var s=new BABYLON.Mesh(e.name+".center",t,e,i),n=i&&null!==i;return s.id=s.name,s.billboardMode=0,s.position.x=.3,s.position.y=.5296,s.position.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,s.scaling.x=1,s.scaling.y=1,s.scaling.z=1,s.isVisible=!0,s.setEnabled(!0),s.checkCollisions=!1,s.receiveShadows=!1,s.castShadows=!1,n||(s.setVerticesData(BABYLON.VertexBuffer.PositionKind,[-.1451,-.06,0,-.1451,.06,0,-.27,-4e-4,0,-.0289,-.06,0,.1449,-.06,0,-.0289,.06,0,.1449,.06,0,.27,0,0],!1),s.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),s.setIndices([0,1,2,3,4,5,6,4,7,1,0,3,4,6,5,5,1,3]),s.subMeshes=[],new BABYLON.SubMesh(0,0,8,0,18,s),s.computeWorldMatrix(!0)),s}var p=new Array(3),g=1,f=0,A=0,B=function(){function i(e,i){void 0===i&&(i="./"),this._scene=e,t.defineMaterials(e,i)}return i.prototype.getModuleName=function(){return"DigitParts"},i.prototype.instance=function(t,i){var s,n=null;switch(t){case"Geometry":s=e(0,!0),null===s?(n=new L("Geometry",this._scene),f+=n.getTotalVertices(),p[0].push(n)):(n=new L("Geometry_"+g++,this._scene,null,s),A+=n.getTotalVertices());break;case"Down":s=e(1),null===s?(n=new O("Down",this._scene),f+=n.getTotalVertices(),p[1].push(n)):(n=new O("Down_"+g++,this._scene,null,s),A+=n.getTotalVertices());break;case"Up":s=e(2),null===s?(n=new b("Up",this._scene),f+=n.getTotalVertices(),p[2].push(n)):(n=new b("Up_"+g++,this._scene,null,s),A+=n.getTotalVertices())}if(null!==n){if(i&&s&&s.skeleton){var o=s.skeleton.name+g;n.skeleton=s.skeleton.clone(o,o)}}else BABYLON.Tools.Error("Mesh not found: "+t);return n},i}();t.MeshFactory=B,t.getStats=s;var y=!1;t.defineMaterials=n,t.defineMultiMaterials=o;var L=function(e){function s(i,s,n,o){void 0===n&&(n="./"),e.call(this,i,s,null,o,!0),t.defineMaterials(s,n);var p=o&&null!==o;this.botLeft=p?r(s,this,o.botLeft):r(s,this),this.topLeft=p?a(s,this,o.topLeft):a(s,this),this.top=p?l(s,this,o.top):l(s,this),this.topRite=p?h(s,this,o.topRite):h(s,this),this.botRite=p?c(s,this,o.botRite):c(s,this),this.bottom=p?u(s,this,o.bottom):u(s,this),this.dot=p?d(s,this,o.dot):d(s,this),this.center=p?_(s,this,o.center):_(s,this),this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=.9523,this.scaling.z=1,this.isVisible=!1,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1}return __extends(s,e),s.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(0)},s}(BABYLON.Mesh);t.Geometry=L;var O=function(e){function s(i,s,n,o){void 0===n&&(n="./"),e.call(this,i,s,null,o,!0),t.defineMaterials(s,n);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=.9523,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,-.0034,0,.0024,-.0017,0,0,0,0,.8105,-.6441,.02,.8105,.6359,.02,-.0866,-.0021,.02,-.0895,-.0041,.02,-.0895,0,.02,.75,-.5368,0,.75,.5299,0,.0024,-.0017,0],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),this.setIndices([0,1,2,3,4,5,6,5,7,8,9,10]),this.setMaterialByID("DigitParts.Multimaterial#0"),this.subMeshes=[],new BABYLON.SubMesh(0,0,8,0,9,this),new BABYLON.SubMesh(1,8,3,9,3,this),this.computeWorldMatrix(!0))}return __extends(s,e),s.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(1)},s}(DIALOG.Letter);t.Down=O;var b=function(e){function s(i,s,n,o){void 0===n&&(n="./"),e.call(this,i,s,null,o,!0),t.defineMaterials(s,n);var r=o&&null!==o;this.id=this.name,this.billboardMode=0,this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.scaling.x=1,this.scaling.y=.9523,this.scaling.z=1,this.isVisible=!0,this.setEnabled(!0),this.checkCollisions=!1,this.receiveShadows=!1,this.castShadows=!1,r||(this.setVerticesData(BABYLON.VertexBuffer.PositionKind,[0,.0034,0,-.0024,.0017,0,0,0,0,-.8105,.6441,.02,-.8105,-.6359,.02,.0866,.0021,.02,.0895,.0041,.02,.0895,0,.02,-.75,.5368,0,-.75,-.5299,0,-.0024,.0017,0],!1),this.setVerticesData(BABYLON.VertexBuffer.NormalKind,[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1],!1),this.setIndices([0,1,2,3,4,5,6,5,7,8,9,10]),this.setMaterialByID("DigitParts.Multimaterial#1"),this.subMeshes=[],new BABYLON.SubMesh(0,0,8,0,9,this),new BABYLON.SubMesh(1,8,3,9,3,this),this.computeWorldMatrix(!0))}return __extends(s,e),s.prototype.dispose=function(t){e.prototype.dispose.call(this,t),i(2)},s}(DIALOG.Letter);t.Up=b}(DigitParts||(DigitParts={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},DIALOG;!function(t){var e,i=function(i){function n(){if(!e){e=new DigitParts.MeshFactory(t.DialogSys._scene);var o=e.instance("Geometry"),r=t.Panel.ExtractMax(o.dot).x+o.dot.position.x+.05,a=t.Panel.ExtractMax(o.top).y+o.top.position.y;n._maxWorld=new BABYLON.Vector3(r,a,0),o.dispose(!1)}i.call(this,e.instance("Geometry")),this.setMaterial(s.MAT),this._minWorld=BABYLON.Vector3.Zero(),this._maxWorld=n._maxWorld,this._maxVisibility=1,this.setDigit("0",!1)}return __extends(n,i),n.prototype.setDigit=function(t,e,i){var s=this._inside;if(-1==="E0123456789-".indexOf(t)||1!==t.length)return void BABYLON.Tools.Error(t+" is not a valid setting for Digit");this._val=t,this._show0=e,this._showDot=i;var n=e&&-1!=="0".indexOf(t);s.botLeft.visibility=-1!=="E268".indexOf(t)||n?this._maxVisibility:0,s.topLeft.visibility=-1!=="E45689".indexOf(t)||n?this._maxVisibility:0,s.top.visibility=-1!=="E2356789".indexOf(t)||n?this._maxVisibility:0,s.bottom.visibility=-1!=="E235689".indexOf(t)||n?this._maxVisibility:0,s.botRite.visibility=-1!=="13456789".indexOf(t)||n?this._maxVisibility:0,s.topRite.visibility=-1!=="1234789".indexOf(t)||n?this._maxVisibility:0,s.center.visibility=-1!=="E2345689-".indexOf(t)?this._maxVisibility:0,s.dot.visibility=i?this._maxVisibility:0},n.prototype.setMaterial=function(t){var e=this._inside;e.botLeft.material=t,e.topLeft.material=t,e.top.material=t,e.bottom.material=t,e.botRite.material=t,e.topRite.material=t,e.center.material=t,e.dot.material=t},n.prototype.disolve=function(t,e){this._maxVisibility=t,this.setDigit(this._val,this._show0,this._showDot)},n.prototype.reAppear=function(){this._maxVisibility=1,this.setDigit(this._val,this._show0,this._showDot)},n.prototype.dispose=function(t){i.prototype.dispose.call(this)},n}(t.MeshWrapperPanel),s=function(e){function s(n,o,r,a){e.call(this,n,t.DialogSys._scene),this._nDigits=o,this._alwaysDot=r,this._fixed=a,this.name=n,s._initMaterial(),this.material=s.MAT;for(var l=0;o>l;l++)this.addSubPanel(new i);this.value=0}return __extends(s,e),Object.defineProperty(s.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t;var e=this._fixed?t.toFixed(this._fixed):t.toString(),i=e.length;-1!==e.indexOf(".")?i--:this._alwaysDot&&(e+=".");var s=this.getSubPanels();if(i>this._nDigits){
s[0].setDigit("E");for(var n=1;n<this._nDigits;n++)s[n].setDigit("0",!1)}else{for(var o=this._nDigits-i,n=0;o>n;n++)s[n].setDigit("0",!1);for(var r=0,n=o;n<this._nDigits;n++){var a="."===e.charAt(r+1);s[n].setDigit(e.charAt(r++),!0,a),a&&r++}}},enumerable:!0,configurable:!0}),s._initMaterial=function(){s.MAT||(s.MAT=t.DialogSys.BLACK[t.DialogSys.USE_CULLING_MAT_FOR_2D?0:1])},s}(t.BasePanel);t.LCD=s;var n=function(i){function n(e,o,r,a,l,h,c){if(void 0===h&&(h=1),i.call(this,e,t.DialogSys._scene),this.minValue=r,this.maxValue=a,this.increment=h,!n.MAT){s._initMaterial();var u=new BABYLON.MultiMaterial("button",t.DialogSys._scene);u.subMaterials.push(s.MAT),u.subMaterials.push(s.MAT),n.MAT=u,u=new BABYLON.MultiMaterial("button selected",t.DialogSys._scene),u.subMaterials.push(s.MAT),u.subMaterials.push(t.DialogSys.ORANGE[0]),n.SELECTED_MAT=u}if(0>=h)return void BABYLON.Tools.Error("increment must positive");if(this.minValue+h>this.maxValue)return void BABYLON.Tools.Error("min value + increment must be <= max value");if(l<this.minValue||l>this.maxValue)return void BABYLON.Tools.Error("initialValue not within min & max values");var d=Math.floor(this.minValue)!==this.minValue||Math.floor(this.maxValue)!==this.maxValue||Math.floor(this.increment)!==this.increment;if(!d&&Math.floor(l)!==l)return void BABYLON.Tools.Error("initialValue must be integer, since minValue, maxValue, & increment are");if(this._display=new s(name+"-lcd",o,d,c),this._display.setBorderVisible(!0),this._display.verticalAlignment=t.Panel.ALIGN_VCENTER,this.value=l,this._display._calcRequiredSize(),e&&null!=e&&e.replace(" ","").length>0){var _=new t.Label(e);_.verticalAlignment=t.Panel.ALIGN_BOTTOM,this.addSubPanel(_)}this.addSubPanel(this._downButton=this._getButton("Down",this)),this.addSubPanel(this._display),this.addSubPanel(this._upButton=this._getButton("Up",this))}return __extends(n,i),n.prototype.dispose=function(t){i.prototype.dispose.call(this,!1),this.unregisterAfterRender(n._normalMaterials)},n.prototype._getButton=function(i,s){var o=e.instance(i),r=t.Panel.ExtractMax(o).y;o.verticalAlignment=t.Panel.ALIGN_VCENTER,o.maxAboveY=r,o.minBelowY=-r,o.material=n.MAT,o.setButton(!0),o.registerAfterRender(n._normalMaterials);var a=this;return o.registerPickAction(function(){o._panelEnabled&&(o.material=n.SELECTED_MAT,"Down"===i?a._decrement():a._increment(),s._callback&&s._callback(s))}),o},n._normalMaterials=function(t){var e=t;e._chngInProgress?(e._chngInProgress=!1,e.material=n.MAT):e.material!==n.MAT&&(e._chngInProgress=!0)},n.prototype._increment=function(){this.value+this.increment<=this.maxValue&&(this.value+=this.increment)},n.prototype._decrement=function(){this.value-this.increment>=this.minValue&&(this.value-=this.increment)},Object.defineProperty(n.prototype,"value",{get:function(){return this._display.value},set:function(t){this._display.value=t},enumerable:!0,configurable:!0}),n}(t.BasePanel);t.NumberScroller=n}(DIALOG||(DIALOG={}));